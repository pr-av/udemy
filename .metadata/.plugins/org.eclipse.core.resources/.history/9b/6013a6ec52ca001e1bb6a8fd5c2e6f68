package com.example.demo.Config;
import org.apache.poi.ss.usermodel.*;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.util.Arrays;
import java.util.List;


public class ExcelReader {
	
	   String filePath = "path/to/your/excel/file.xlsx";

       // Replace this list with the ApartmentIds you want to search for
       List<Integer> targetIds = Arrays.asList(21, 22, 23);

       try {
           FileInputStream fileInputStream = new FileInputStream(new File(filePath));
           Workbook workbook = new XSSFWorkbook(fileInputStream);
           Sheet sheet = workbook.getSheetAt(0); // Assuming data is in the first sheet

           int idColumnIndex = 0; // Assuming the ApartmentId column is the first column (0-indexed)
           int urlColumnIndex = 2; // Assuming the ApartmentUrl column is the third column

           List<Row> rows = sheet.subList(1, sheet.getLastRowNum() + 1); // Exclude header row

           for (Integer targetId : targetIds) {
               for (Row row : rows) {
                   Cell idCell = row.getCell(idColumnIndex, Row.MissingCellPolicy.RETURN_BLANK_AS_NULL);
                   if (idCell != null && idCell.getCellType() == CellType.NUMERIC) {
                       int currentId = (int) idCell.getNumericCellValue();
                       if (currentId == targetId) {
                           Cell urlCell = row.getCell(urlColumnIndex, Row.MissingCellPolicy.RETURN_BLANK_AS_NULL);

                           String url = (urlCell != null) ? urlCell.getStringCellValue() : "";

                           System.out.println("ApartmentId: " + currentId);
                           System.out.println("ApartmentUrl: " + url);
                           System.out.println();

                           // Move to the next target ID
                           break;
                       }
                   }
               }
           }

           workbook.close();
           fileInputStream.close();
       } catch (IOException e) {
           e.printStackTrace();
       }
   }

}
