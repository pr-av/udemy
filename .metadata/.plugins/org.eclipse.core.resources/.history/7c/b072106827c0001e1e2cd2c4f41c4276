package com.example.demo.ServiceImpl;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.example.demo.Exception.UnitNotFoundException;
import com.example.demo.Repository.UnitsRepository;
import com.example.demo.Service.UnitsService;
import com.example.demo.model.UnitStatus;
import com.example.demo.model.Units;
@Service
public class UnitserviceImpl implements UnitsService {
@Autowired
UnitsRepository unitsRepository;
	
@Override
public List<Units> getAllUnits() {
    return unitsRepository.findAll();
}

@Override
public Units getUnitByName(String name) {
    return unitsRepository.getUnitByUnitName(name)
            .orElseThrow(() -> new UnitNotFoundException(name));
}

@Override
public List<Units> getActiveUnits() {
    return unitsRepository.findByUnitStatusTrue(UnitStatus.ACTIVE);
}

@Override
public Units createUnit(Units unit) {
    return unitsRepository.save(unit);
}

@Override
public Units updateUnitActiveStatus(String name, UnitStatus active) {
    return unitsRepository.getUnitByUnitName(name).map(existingUnit->{
                existingUnit.setUnitStatus(active);
                return unitsRepository.save(existingUnit);
            })
            .orElseThrow(() -> new UnitNotFoundException("Unit with name " + name + " not found"));
}

@Override
public void deleteUnit(String name) {
	Optional<Units> unit=unitsRepository.getUnitByUnitName(name);
	unitsRepository.deleteById(unit.get().getId());
}

}
